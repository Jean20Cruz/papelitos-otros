<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGROSERVICIO Y FERRETERIA BUJAIDA</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 500px;
            margin: 20px auto;
            background: #fff;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #000000;
        }
        label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }
        input, button {
            width: 100%;
            padding: 12px;
            margin-top: 5px;
            margin-bottom: 15px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            background-color: #5cb85c;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background-color: #4cae4c;
        }
        .ticket-box {
            border-top: 2px dashed #ccc;
            margin-top: 20px;
            padding-top: 20px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
        }
        .ticket-box h3 {
            text-align: center;
            margin-top: 0;
        }
        .item-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        hr {
            border: none;
            border-top: 1px solid #eee;
            margin: 10px 0;
        }
        #total-pagar {
            font-size: 18px;
            font-weight: bold;
            color: #000000;
        }
        #imprimir-btn {
            background-color: #0275d8;
            margin-top: 20px;
        }
        #imprimir-btn:hover {
            background-color: #025aa5;
        }
        #cliente-nombre {
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
        }

        .switch-container {
            text-align: center;
            margin-bottom: 20px;
        }

        /* Estilos para impresi√≥n */
        @media print {
            body {
                visibility: hidden;
            }
            .print-area {
                visibility: visible;
                display: block !important;
                position: absolute;
                left: 0;
                top: 0;
            }
            .print-copy {
                border: 1px solid black;
                margin-bottom: 20px;
                padding: 10px;
            }
            .no-print {
                display: none;
            }
            h1, label, input, button {
                display: none;
            }
            .ticket-box {
                border-top: none;
            }
            .ticket-simple {
                font-family: 'Courier New', Courier, monospace;
                font-size: 12px;
                padding: 0;
                margin: 0;
            }
            .ticket-simple h3, .ticket-simple hr {
                display: none;
            }
        }
    </style>
    <link rel="manifest" href="manifest.json">
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registrado con √©xito:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Fallo el registro del Service Worker:', error);
                    });
            });
        }
    </script>
</head>
<body>

<div class="container no-print">
    <h1>AGROSERVICIO Y FERRETERIA BUJAIDA</h1>
    
    <div class="switch-container">
        <label for="modo-venta">Modo de Venta:</label>
        <button id="modo-venta" onclick="cambiarModoVenta()">PAPELITOS</button>
    </div>

    <label for="cliente">Nombre del Cliente:</label>
    <input type="text" id="cliente" placeholder="Escriba el nombre del cliente...">

    <label for="producto">Producto:</label>
    <input type="text" id="producto" list="listaProductos" placeholder="Buscar producto...">
    
    <label for="cantidad">Cantidad:</label>
    <input type="number" id="cantidad" value="1" min="1">
    
    <button onclick="agregarProducto()">A√±adir a la venta</button>
    
    <div class="ticket-box">
        <h3>Detalle de la Venta</h3>
        <p id="cliente-nombre-placeholder" style="display:none;"></p>
        <div id="lista-productos-vendidos">
        </div>
        <hr>
        <div class="item-row">
            <strong>Total:</strong>
            <strong id="total-pagar">$0.00</strong>
        </div>
    </div>
    
    <button id="imprimir-btn" onclick="imprimirTickets()">Imprimir Ticket üñ®Ô∏è</button>
</div>

<div class="print-area" style="display:none;"></div>

<datalist id="listaProductosPapelitos">
    <option value="qq DE MAICILLO $35.00">
    <option value="@ MAICILLO $9.00">
    <option value="MAICILLO $1.00">
    <option value="1/2 @ MAICILLO $4.50">
    <option value="BOTELLA DE MIEL $6.00">
    <option value="1/2 BOTELLA DE MIEL $4.00">
    <option value="LAZO BUEYERO $1.50">
    <option value="LAZO BUEYERO DE COLOR $1.50">
    <option value="LAZO DE COLORES PEQUE√ëOS $1.00">
    <option value="VALDE DE LECHE $7.50">
    <option value="1/2 BOTELLA DE LECHE $3.00">
    <option value="1/2 DE 5 BOTELLAS DE LECHE $9.00">
    <option value="1/2 DE 10 BOTELLAS DE LECHE $14.00">
    <option value="BARRIL PLASTICO CERRADO $39.00">
    <option value="BARRIL PLASTICO ABIERTO $38.00">
    <option value="MITAD DE BARRIL $22.00">
    <option value="BARRIL METALICO $19.00">
    <option value="COMEDERO INDIVIDUAL PARA GANADO $60.00">
    <option value="COMEDERO DOBLE PARA GANADO $165.00">
    <option value="CUBETAS PLASTICAS PEQUE√ëAS $3.00">
    <option value="CUBETAS PLASTICAS GRANDES $4.00">
    <option value="SACOS GRANDES $0.75">
    <option value="SACOS PEQUE√ëOS $0.45">
    <option value="LINGAS 30 VARAS $10.00">
    <option value="LADRILLO DE OBRA $0.38">
    <option value="GRANZA $5.50">
    <option value="ARENA METRO $20">
    <option value="ARENA 1/2 METRO $10"> 
    <option value="ARENA CUBETA $0.65">
    <option value="PACAS $4.25">
    <option value="ONZA PIPIAN $0.50">
    <option value="HOJUELAS $0.50">
    <option value="NUGALLO LIBRA $1.85">
    <option value="CUBETA USADA $3.00">
    <option value="SIERRA LIQUIDACI√ìN $0.50">
    <option value="PASTILLA P/CUAJO $0.50">
    <option value="GARRAFON SOLO AGUA $3.00">
    <option value="GARRAFON CON AGUA $7.00">
    <option value="TRANSPORTE $5.00">
    <option value="TRANSPORTE $10.00">
    <option value="TRANSPORTE $15.00">
    <option value="LAZO COLOR MEDIANO $1.25">
    <option value="LACITO COLOR PEQUE√ëO $0.75">
    <option value="HUESO PREMIO $3.00">
    <option value="CEPILLO P/PERRO $2.00">
    <option value="KIT DE U√ëA P/PERRO $6.00">
    <option value="CORREAS COLORES $2.00">
    <option value="CADENA DE FUERZA $1.75">
    <option value="COLLAR DOBLE GRANDE $7.00">
    <option value="CADENA P/PERRO 2.0MM $2.00">
    <option value="CADENA P/PERRO 2.5MM $3.00">
    <option value="CADENA P/PERRO 3.0MM $3.50">
    <option value="CADENA P/PERRO 3.5MM $4.00">
    <option value="COLLA P/RAZAS PEQUE√ëAS $2.50">
    <option value="COLLAR CORBATIN P/GATO $2.00">
    <option value="BOSAL GRANDE P/PERRO $5.00">
    <option value="COLLAR REFLECTIVO GRANDE $9.00">
    <option value="PECHERA MINI $2.50">
    <option value="PECHERA MEDIANA $3.00">
    <option value="PECHERA GRANDE $4.50">
    <option value="COLLAR GRANDE $3.50">
    <option value="CAMA DE GATO $10.00">
    <option value="COLLAR EXTRA GRANDE REFORZADO $8.50">
    <option value="COLLAR GRANDE REFORZADO $5.00">
    <option value="COLLAR MEDIANO REFORZADO $4.00">
    <option value="COLLAR PEQUE√ëO REFORZADO $2.50">
    <option value="POSTE DE CEMENTO $13.00">
    <option value="REPARACI√ìN EXPRESS STIHL $15.00">
    <option value="REPARACI√ìN INTERMEDIA STIHL $20.00">
    <option value="REPARACI√ìN AVANZADA STIHL $30.00">
    <option value="ONZA MARSHALL $2.00">
    <option value="WELLCAP CACHORRO $1.00">
    <option value="WELLCAP ADULTO $2.00">
    <option value="AGITA 10WG BOLSITA $1.50">
    <option value="TANQUE ENREJADO $135.00">
</datalist>

<datalist id="listaProductosBebidasPaletas">
    <option value="POWER 1L $1.25">
    <option value="GATORADE 1L $1.25">
    <option value="LIPTON TEA 500ML $1.00">
    <option value="LIPTON LATA $1.00">
    <option value="AMP FORTE ENERGIZANTE RECARGADO $1.00">
    <option value="COCA COLA LATA $0.75">
    <option value="COCA COLA 1.5L $1.25">
    <option value="SALUTARIS LATA $0.75">
    <option value="SALUTARIS 1.25L $1.25">
    <option value="PEPSI 1.25L $1.25">
    <option value="KINLEY LATA $0.75">
    <option value="PETIT 600ML $0.50">
    <option value="PETIT LATA $0.75">
    <option value="JUGO DEL VALLE $0.50">
    <option value="AGUA 500ML $0.50">
    <option value="AGUA CRISTAL 500ML $0.50">
    <option value="AGUA CRISTAL 1L $0.75">
    <option value="FARDO DE AGUA $1.25">
    <option value="BOLSA DE AGUA X1 $0.15">
    <option value="BOLSA DE AGUA X2 $0.25">
    <option value="RAPTOR $1.00">
    <option value="PILSENER LATA $1.50">
    <option value="CORONA VIDRIO $1.85">
    <option value="MICHELOB ULTRA $2.00">
    <option value="STELA ARTOIS $2.00">
    <option value="FRUTADO $0.50">
    <option value="DE LA GRANJA PEQUE√ëO $0.60">
    <option value="DE LA GRANJA GRANDE $1.00">
    <option value="COPA SUNDAE $1.50">
    <option value="VASITO $0.75">
    <option value="CONO SUNDAE $1.00">
    <option value="CHOCOCONO $1.00">
    <option value="CHOCO CONITO $0.35">
    <option value="GIGA ALMENDRA $1.50">
    <option value="GIGA CLASICA $1.50">
    <option value="CINTA NEGRA $1.00">
    <option value="CINTA NEGRA CRISPY $1.25">
    <option value="BLOCK $0.85">
    <option value="SANDWICH $1.00">
    <option value="SANDWICHITO $1.00">
    <option value="SANDIA $0.75">
    <option value="HELADO TIPO CASERO $0.75">
    <option value="CREMOSA $0.85">
    <option value="PALITO $0.35">
    <option value="FRUTA $0.75">
    <option value="FRESCA LATA $0.75">
</datalist>

<script>
    const productosPapelitos = {
        "qq DE MAICILLO $35.00": 35.00,
        "@ MAICILLO $9.00": 9.00,
        "MAICILLO $1.00": 1.00,
        "1/2 @ MAICILLO $4.50": 4.50,
        "BOTELLA DE MIEL $6.00": 6.00,
        "1/2 BOTELLA DE MIEL $4.00": 4.00,
        "LAZO BUEYERO $1.50": 1.50,
        "LAZO BUEYERO DE COLOR $1.50": 1.50,
        "LAZO DE COLORES PEQUE√ëOS $1.00": 1.00,
        "VALDE DE LECHE $7.50": 7.50,
        "1/2 BOTELLA DE LECHE $3.00": 3.00,
        "1/2 DE 5 BOTELLAS DE LECHE $9.00": 9.00,
        "1/2 DE 10 BOTELLAS DE LECHE $14.00": 14.00,
        "BARRIL PLASTICO CERRADO $39.00": 39.00,
        "BARRIL PLASTICO ABIERTO $38.00": 38.00,
        "MITAD DE BARRIL $22.00": 22.00,
        "BARRIL METALICO $19.00": 19.00,
        "COMEDERO INDIVIDUAL PARA GANADO $60.00": 60.00,
        "COMEDERO DOBLE PARA GANADO $165.00": 165.00,
        "CUBETAS PLASTICAS PEQUE√ëAS $3.00": 3.00,
        "CUBETAS PLASTICAS GRANDES $4.00": 4.00,
        "SACOS GRANDES $0.75": 0.75,
        "SACOS PEQUE√ëOS $0.45": 0.45,
        "LINGAS 30 VARAS $10.00": 10.00,
        "LADRILLO DE OBRA $0.38": 0.38,
        "GRANZA $5.50": 5.50,
        "ARENA METRO $20": 20.00,
        "ARENA 1/2 METRO $10": 10.00, 
        "ARENA CUBETA $0.65": 0.65,
        "PACAS $4.25": 4.25,
        "ONZA PIPIAN $0.50": 0.50,
        "HOJUELAS $0.50": 0.50,
        "NUGALLO LIBRA $1.85": 1.85,
        "CUBETA USADA $3.00": 3.00,
        "SIERRA LIQUIDACI√ìN $0.50": 0.50,
        "PASTILLA P/CUAJO $0.50": 0.50,
        "GARRAFON SOLO AGUA $3.00": 3.00,
        "GARRAFON CON AGUA $7.00": 7.00,
        "TRANSPORTE $5.00": 5.00,
        "TRANSPORTE $10.00": 10.00,
        "TRANSPORTE $15.00": 15.00,
        "LAZO COLOR MEDIANO $1.25": 1.25,
        "LACITO COLOR PEQUE√ëO $0.75": 0.75,
        "HUESO PREMIO $3.00": 3.00,
        "CEPILLO P/PERRO $2.00": 2.00,
        "KIT DE U√ëA P/PERRO $6.00": 6.00,
        "CORREAS COLORES $2.00": 2.00,
        "CADENA DE FUERZA $1.75": 1.75,
        "COLLAR DOBLE GRANDE $7.00": 7.00,
        "CADENA P/PERRO 2.0MM $2.00": 2.00,
        "CADENA P/PERRO 2.5MM $3.00": 3.00,
        "CADENA P/PERRO 3.0MM $3.50": 3.50,
        "CADENA P/PERRO 3.5MM $4.00": 4.00,
        "COLLA P/RAZAS PEQUE√ëAS $2.50": 2.50,
        "COLLAR CORBATIN P/GATO $2.00": 2.00,
        "BOSAL GRANDE P/PERRO $5.00": 5.00,
        "COLLAR REFLECTIVO GRANDE $9.00": 9.00,
        "PECHERA MINI $2.50": 2.50,
        "PECHERA MEDIANA $3.00": 3.00,
        "PECHERA GRANDE $4.50": 4.50,
        "COLLAR GRANDE $3.50": 3.50,
        "CAMA DE GATO $10.00": 10.00,
        "COLLAR EXTRA GRANDE REFORZADO $8.50": 8.50,
        "COLLAR GRANDE REFORZADO $5.00": 5.00,
        "COLLAR MEDIANO REFORZADO $4.00": 4.00,
        "COLLAR PEQUE√ëO REFORZADO $2.50": 2.50,
        "POSTE DE CEMENTO $13.00": 13.00,
        "REPARACI√ìN EXPRESS STIHL $15.00": 15.00,
        "REPARACI√ìN INTERMEDIA STIHL $20.00": 20.00,
        "REPARACI√ìN AVANZADA STIHL $30.00": 30,
        "ONZA MARSHALL $2.00": 2.00,
        "WELLCAP CACHORRO $1.00": 1.00,
        "WELLCAP ADULTO $2.00": 2.00,
        "AGITA 10WG BOLSITA $1.50": 1.50
        "TANQUE ENREJADO $135.00": 135.00
    };

    const productosBebidasPaletas = {
        "POWER 1L $1.25": 1.25,
        "GATORADE 1L $1.25": 1.25,
        "LIPTON TEA 500ML $1.00": 1.00,
        "LIPTON LATA $1.00": 1.00,
        "AMP FORTE ENERGIZANTE RECARGADO $1.00": 1.00,
        "COCA COLA LATA $0.75": 0.75,
        "COCA COLA 1.5L $1.25": 1.25,
        "SALUTARIS LATA $0.75": 0.75,
        "SALUTARIS 1.25L $1.25": 1.25,
        "PEPSI 1.25L $1.25": 1.25,
        "KINLEY LATA $0.75": 0.75,
        "PETIT 600ML $0.50": 0.50,
        "PETIT LATA $0.75": 0.75,
        "JUGO DEL VALLE $0.50": 0.50,
        "AGUA 500ML $0.50": 0.50,
        "AGUA CRISTAL 500ML $0.50": 0.50,
        "AGUA CRISTAL 1L $0.75": 0.75,
        "FARDO DE AGUA $1.25": 1.25,
        "BOLSA DE AGUA X1 $0.15": 0.15,
        "BOLSA DE AGUA X2 $0.25": 0.25,
        "RAPTOR $1.00": 1.00,
        "PILSENER LATA $1.50": 1.50,
        "CORONA VIDRIO $1.85": 1.85,
        "MICHELOB ULTRA $2.00": 2.00,
        "STELA ARTOIS $2.00": 2.00,
        "FRUTADO $0.50": 0.50,
        "DE LA GRANJA PEQUE√ëO $0.60": 0.60,
        "DE LA GRANJA GRANDE $1.00": 1.00,
        "COPA SUNDAE $1.50": 1.50,
        "VASITO $0.75": 0.75,
        "CONO SUNDAE $1.00": 1.00,
        "CHOCOCONO $1.00": 1.00,
        "CHOCO CONITO $0.35": 0.35,
        "GIGA ALMENDRA $1.50": 1.50,
        "GIGA CLASICA $1.50": 1.50,
        "CINTA NEGRA $1.00": 1.00,
        "CINTA NEGRA CRISPY $1.25": 1.25,
        "BLOCK $0.85": 0.85,
        "SANDWICH $1.00": 1.00,
        "SANDWICHITO $1.00": 1.00,
        "SANDIA $0.75": 0.75,
        "HELADO TIPO CASERO $0.75": 0.75,
        "CREMOSA $0.85": 0.85,
        "PALITO $0.35": 0.35,
        "FRUTA $0.75": 0.75,
        "FRESCA LATA $0.75": 0.75
    };

    let modoActual = 'papelitos';
    let productos = productosPapelitos;

    let totalVenta = 0;
    const listaProductosVendidos = document.getElementById('lista-productos-vendidos');
    const totalPagar = document.getElementById('total-pagar');
    const clienteInput = document.getElementById('cliente');
    const productoInput = document.getElementById('producto');
    const modoVentaBtn = document.getElementById('modo-venta');
    const imprimirBtn = document.getElementById('imprimir-btn');
    
    function cambiarModoVenta() {
        if (modoActual === 'papelitos') {
            modoActual = 'bebidas_paletas';
            productos = productosBebidasPaletas;
            modoVentaBtn.textContent = 'BEBIDAS / PALETAS';
            productoInput.setAttribute('list', 'listaProductosBebidasPaletas');
            imprimirBtn.textContent = 'Imprimir Ticket üñ®Ô∏è';
        } else {
            modoActual = 'papelitos';
            productos = productosPapelitos;
            modoVentaBtn.textContent = 'PAPELITOS';
            productoInput.setAttribute('list', 'listaProductosPapelitos');
            imprimirBtn.textContent = 'Imprimir 2 Copias üñ®Ô∏è';
        }
        // Limpiar la venta actual al cambiar de modo
        listaProductosVendidos.innerHTML = '';
        totalVenta = 0;
        totalPagar.textContent = '$0.00';
        productoInput.value = '';
    }

    function agregarProducto() {
        const nombreProducto = document.getElementById('producto').value;
        const cantidad = parseInt(document.getElementById('cantidad').value);

        const precioUnitario = productos[nombreProducto];

        if (precioUnitario && cantidad > 0) {
            const precioTotalProducto = precioUnitario * cantidad;

            const div = document.createElement('div');
            div.className = 'item-row';
            div.innerHTML = `
                <span>${nombreProducto} (${cantidad} x $${precioUnitario.toFixed(2)})</span>
                <span>$${precioTotalProducto.toFixed(2)}</span>
            `;
            listaProductosVendidos.appendChild(div);

            totalVenta += precioTotalProducto;
            totalPagar.textContent = `$${totalVenta.toFixed(2)}`;

            document.getElementById('producto').value = '';
            document.getElementById('cantidad').value = '1';

        } else {
            alert('‚ùå Producto no encontrado o cantidad inv√°lida.');
        }
    }

    function imprimirTickets() {
        const printArea = document.querySelector('.print-area');
        let ticketHTML = '';
        const fechaActual = new Date().toLocaleString();

        if (modoActual === 'papelitos') {
            const ticketContent = document.querySelector('.ticket-box').innerHTML;
            const clienteNombre = clienteInput.value || "Clientes Varios";
            
            const copiaCliente = `
                <div class="print-copy">
                    <h3 style="text-align: center;">COPIA CLIENTE</h3>
                    <p style="text-align: center;">${fechaActual}</p>
                    <p style="text-align: center;">** Gracias por su compra **</p>
                    <hr>
                    <p><strong>Cliente:</strong> ${clienteNombre}</p>
                    ${ticketContent}
                </div>
            `;
            
            const copiaCaja = `
                <div class="print-copy">
                    <h3 style="text-align: center;">COPIA CAJA</h3>
                    <p style="text-align: center;">${fechaActual}</p>
                    <p style="text-align: center;">** Registro Interno **</p>
                    <hr>
                    <p><strong>Cliente:</strong> ${clienteNombre}</p>
                    ${ticketContent}
                </div>
            `;
            ticketHTML = copiaCliente + copiaCaja;

        } else if (modoActual === 'bebidas_paletas') {
            const items = listaProductosVendidos.querySelectorAll('.item-row');
            let itemsText = '';
            items.forEach(item => {
                const [nombre, precio] = item.textContent.trim().split(/\s{2,}/);
                itemsText += `<p class="ticket-simple">${nombre} ${precio}</p>`;
            });

            const totalText = totalPagar.textContent;
            ticketHTML = `
                <div class="ticket-simple">
                    <p>${fechaActual}</p>
                    ${itemsText}
                    <p>-------------------------</p>
                    <p>Total:      ${totalText}</p>
                </div>
            `;
        }
        
        printArea.innerHTML = ticketHTML;
        
        printArea.style.display = 'block';
        window.print();
        printArea.style.display = 'none';
    }

    // Configuraci√≥n inicial del datalist
    productoInput.setAttribute('list', 'listaProductosPapelitos');
</script>

</body>
</html>
